<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firestore Templates Setup Tool</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            padding: 30px;
            color: white;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }
        
        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        .content {
            padding: 40px;
        }
        
        .config-section {
            background: #f8f9ff;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
            border: 2px solid #e3e8ff;
        }
        
        .section-title {
            font-size: 1.4rem;
            color: #4c51bf;
            margin-bottom: 20px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #374151;
        }
        
        input, textarea {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #d1d5db;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s ease;
        }
        
        input:focus, textarea:focus {
            outline: none;
            border-color: #4f46e5;
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            margin: 10px 10px 10px 0;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .btn-success {
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #f56565 0%, #e53e3e 100%);
        }
        
        .status {
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            font-weight: 500;
        }
        
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .status.info {
            background: #cce7ff;
            color: #004085;
            border: 1px solid #b3d9ff;
        }
        
        .progress {
            width: 100%;
            height: 8px;
            background: #e2e8f0;
            border-radius: 4px;
            overflow: hidden;
            margin: 20px 0;
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #4facfe 0%, #00f2fe 100%);
            transition: width 0.3s ease;
            width: 0%;
        }
        
        .template-preview {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            font-size: 14px;
        }
        
        .template-preview h4 {
            color: #4c51bf;
            margin-bottom: 8px;
        }
        
        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        @media (max-width: 768px) {
            .grid {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .content {
                padding: 20px;
            }
        }
        
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üöÄ Firestore Templates Setup</h1>
            <p>–®–≤–∏–¥–∫–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Ç–µ–º–ø–ª–µ–π—Ç—ñ–≤ –¥–ª—è –≥—Ä—É–ø</p>
        </div>
        
        <div class="content">
            <div class="config-section">
                <h2 class="section-title">‚ö†Ô∏è –í–∞–∂–ª–∏–≤–æ: –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Firestore Rules</h2>
                <p><strong>–ü–µ—Ä–µ–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º —Ç—É–ª–∑–∏</strong> —Ç–∏–º—á–∞—Å–æ–≤–æ –∑–º—ñ–Ω—ñ—Ç—å –ø—Ä–∞–≤–∏–ª–∞ Firestore –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ñ:</p>
                <div class="template-preview">
                    <h4>üîì –¢–∏–º—á–∞—Å–æ–≤—ñ –ø—Ä–∞–≤–∏–ª–∞ (–¢–Ü–õ–¨–ö–ò –î–õ–Ø –ù–ê–õ–ê–®–¢–£–í–ê–ù–ù–Ø!):</h4>
                    <pre style="background: #f1f5f9; padding: 10px; border-radius: 5px; font-size: 12px;">
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    match /{document=**} {
      allow read, write: if request.auth != null;
    }
  }
}</pre>
                    <p style="color: #dc2626; font-weight: 600; margin-top: 10px;">
                        ‚ö†Ô∏è –ü—ñ—Å–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–µ–º–ø–ª–µ–π—Ç—ñ–≤ –æ–±–æ–≤'—è–∑–∫–æ–≤–æ –ø–æ–≤–µ—Ä–Ω—ñ—Ç—å –±–µ–∑–ø–µ—á–Ω—ñ –ø—Ä–∞–≤–∏–ª–∞!
                    </p>
                </div>
                <p><strong>–î–µ –∑–º—ñ–Ω–∏—Ç–∏:</strong> Firebase Console ‚Üí Firestore Database ‚Üí Rules ‚Üí Publish</p>
            </div>
            <div class="config-section">
                <h2 class="section-title">üîß –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Firebase</h2>
                <div class="grid">
                    <div class="form-group">
                        <label for="apiKey">API Key:</label>
                        <input type="text" id="apiKey" placeholder="–í–∞—à Firebase API Key">
                    </div>
                    <div class="form-group">
                        <label for="projectId">Project ID:</label>
                        <input type="text" id="projectId" placeholder="your-project-id">
                    </div>
                </div>
                <button class="btn" onclick="initFirebase()">
                    üîå –ü—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è –¥–æ Firebase
                </button>
            </div>
            
            <!-- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è -->
            <div class="config-section">
                <h2 class="section-title">üîê –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è</h2>
                <p>–î–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–µ–º–ø–ª–µ–π—Ç—ñ–≤ –ø–æ—Ç—Ä—ñ–±–Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è –≤ Firebase:</p>
                <button class="btn" onclick="signInAnonymously()" id="authBtn">
                    üîë –ê–≤—Ç–æ—Ä–∏–∑—É–≤–∞—Ç–∏—Å—è –∞–Ω–æ–Ω—ñ–º–Ω–æ
                </button>
                <div id="authStatus" class="status info" style="display: none;">
                    –°—Ç–∞—Ç—É—Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó: <span id="authStatusText">–ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π</span>
                </div>
            </div>
            
            <!-- –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –≥—Ä—É–ø–∏ -->
            <div class="config-section">
                <h2 class="section-title">üë• –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –≥—Ä—É–ø–∏</h2>
                <div class="form-group">
                    <label for="groupId">ID –≥—Ä—É–ø–∏:</label>
                    <input type="text" id="groupId" placeholder="military_group_1" value="military_group_1">
                </div>
                <div class="form-group">
                    <label for="groupName">–ù–∞–∑–≤–∞ –≥—Ä—É–ø–∏:</label>
                    <input type="text" id="groupName" placeholder="–í—ñ–π—Å—å–∫–æ–≤–∞ –≥—Ä—É–ø–∞ 1" value="–í—ñ–π—Å—å–∫–æ–≤–∞ –≥—Ä—É–ø–∞ 1">
                </div>
            </div>
            
            <!-- –ü–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –ø–µ—Ä–µ–≥–ª—è–¥ -->
            <div class="config-section">
                <h2 class="section-title">üëÄ –ü–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –ø–µ—Ä–µ–≥–ª—è–¥ —Ç–µ–º–ø–ª–µ–π—Ç—ñ–≤</h2>
                <p>–ë—É–¥–µ —Å—Ç–≤–æ—Ä–µ–Ω–æ <strong>12 —Ç–µ–º–ø–ª–µ–π—Ç—ñ–≤</strong> —Ç–∞ <strong>3 –Ω–∞–±–æ—Ä–∏ –∞–≤—Ç–æ–¥–æ–ø–æ–≤–Ω–µ–Ω–Ω—è</strong>:</p>
                <div id="templatesPreview">
                    <div class="template-preview">
                        <h4>üìö –¢–µ–º–ø–ª–µ–π—Ç–∏ –∑–∞–Ω—è—Ç—å (4 —à—Ç.)</h4>
                        <p>–¢1-–¢4: –ü—Å–∏—Ö–æ–ª–æ–≥—ñ—á–Ω–∞ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∞, –ù–¢–ö –ü–°–ü, –û–±–∫–∞—Ç–∫–∞ —Ç–∞–Ω–∫–æ–º</p>
                    </div>
                    <div class="template-preview">
                        <h4>üí™ –¢–µ–º–ø–ª–µ–π—Ç–∏ —Ç—Ä–µ–Ω—É–≤–∞–Ω—å (4 —à—Ç.)</h4>
                        <p>–°—Ç—Ä–æ–π–æ–≤–∞, —Ñ—ñ–∑–∏—á–Ω–∞, —Å—Ç—Ä—ñ–ª–µ—Ü—å–∫–∞ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∞, —Ç–µ—Ö–Ω—ñ—á–Ω–∞ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∞</p>
                    </div>
                    <div class="template-preview">
                        <h4>üéØ –Ü–Ω—à—ñ —Ç–µ–º–ø–ª–µ–π—Ç–∏ (4 —à—Ç.)</h4>
                        <p>–ü–ª–∞–Ω–µ—Ä–∫–∏, –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏, —Ü–µ—Ä–µ–º–æ–Ω—ñ—ó, –º–µ–¥–∏—á–Ω–∞ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∞</p>
                    </div>
                </div>
            </div>
            
            <!-- –î—ñ—ó -->
            <div class="config-section">
                <h2 class="section-title">‚ö° –î—ñ—ó</h2>
                <button class="btn btn-success" onclick="createTemplates()" id="createBtn">
                    ‚ú® –°—Ç–≤–æ—Ä–∏—Ç–∏ –≤—Å—ñ —Ç–µ–º–ø–ª–µ–π—Ç–∏
                </button>
                <button class="btn btn-danger" onclick="deleteAllTemplates()" id="deleteBtn" disabled>
                    üóëÔ∏è –í–∏–¥–∞–ª–∏—Ç–∏ –≤—Å—ñ —Ç–µ–º–ø–ª–µ–π—Ç–∏
                </button>
                <button class="btn" onclick="checkExisting()" id="checkBtn" disabled>
                    üîç –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —ñ—Å–Ω—É—é—á—ñ
                </button>
            </div>
            
            <!-- –ü—Ä–æ–≥—Ä–µ—Å -->
            <div class="progress hidden" id="progressContainer">
                <div class="progress-bar" id="progressBar"></div>
            </div>
            
            <!-- –°—Ç–∞—Ç—É—Å -->
            <div id="status"></div>
        </div>
    </div>

    <!-- Firebase SDK (v8 compat) -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>

    <script>
        let db = null;
        let auth = null;
        let isFirebaseInitialized = false;
        let isAuthenticated = false;

        // –î–µ—Ñ–æ–ª—Ç–Ω—ñ —Ç–µ–º–ø–ª–µ–π—Ç–∏
        const defaultTemplates = [
            {
                title: "–¢1",
                description: "–ü—Ä–∏–π–æ–º–∏ –ø—Å–∏—Ö—ñ—á–Ω–æ—ó —Å–∞–º–æ—Ä–µ–≥—É–ª—è—Ü—ñ—ó. –ü–µ—Ä—à–∞ –ø—Å–∏—Ö–æ–ª–æ–≥—ñ—á–Ω–∞ –¥–æ–ø–æ–º–æ–≥–∞ —Ç–∞ —Å–∞–º–æ–¥–æ–ø–æ–º–æ–≥–∞",
                location: "–ù–∞–≤—á–∞–ª—å–Ω–∏–π –∫–ª–∞—Å",
                unit: "",
                tags: ["–ø—Å–∏—Ö–æ–ª–æ–≥—ñ—è", "—Ç–µ–æ—Ä—ñ—è"],
                durationMinutes: 180,
                type: "lesson",
                isDefault: true,
                createdBy: "system",
                customFields: {}
            },
            {
                title: "–¢2",
                description: "–§–æ—Ä–º—É–≤–∞–Ω–Ω—è —Ç–∞ –∑–º—ñ—Ü–Ω–µ–Ω–Ω—è –ø—Å–∏—Ö–æ–ª–æ–≥—ñ—á–Ω–æ—ó —Å—Ç—ñ–π–∫–æ—Å—Ç—ñ –æ—Å–æ–±–æ–≤–æ–≥–æ —Å–∫–ª–∞–¥—É –ø—ñ–¥ —á–∞—Å –ø–æ–¥–æ–ª–∞–Ω–Ω—è —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–æ—ó —Å–º—É–≥–∏ –ø–µ—Ä–µ—à–∫–æ–¥",
                location: "–ù–¢–ö –ü–°–ü",
                unit: "",
                tags: ["–ø—Å–∏—Ö–æ–ª–æ–≥—ñ—è", "–ø—Ä–∞–∫—Ç–∏–∫–∞"],
                durationMinutes: 320,
                type: "lesson",
                isDefault: true,
                createdBy: "system",
                customFields: {}
            },
            {
                title: "–¢3",
                description: "–§–æ—Ä–º—É–≤–∞–Ω–Ω—è —Ç–∞ –∑–º—ñ—Ü–Ω–µ–Ω–Ω—è –ø—Å–∏—Ö–æ–ª–æ–≥—ñ—á–Ω–æ—ó —Å—Ç—ñ–π–∫–æ—Å—Ç—ñ –æ—Å–æ–±–æ–≤–æ–≥–æ —Å–∫–ª–∞–¥—É –ø—ñ–¥ —á–∞—Å –±–æ—Ä–æ—Ç—å–±–∏ –∑ –±—Ä–æ–Ω–µ—Ç–µ—Ö–Ω—ñ–∫–æ—é –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞",
                location: "–û–±–∫–∞—Ç–∫–∞ —Ç–∞–Ω–∫–æ–º",
                unit: "",
                tags: ["–ø—Å–∏—Ö–æ–ª–æ–≥—ñ—è", "–ø—Ä–∞–∫—Ç–∏–∫–∞", "–±—Ä–æ–Ω–µ—Ç–µ—Ö–Ω—ñ–∫–∞"],
                durationMinutes: 210,
                type: "lesson",
                isDefault: true,
                createdBy: "system",
                customFields: {}
            },
            {
                title: "–¢4",
                description: "–§–æ—Ä–º—É–≤–∞–Ω–Ω—è —Ç–∞ –∑–º—ñ—Ü–Ω–µ–Ω–Ω—è –ø—Å–∏—Ö–æ–ª–æ–≥—ñ—á–Ω–æ—ó —Å—Ç—ñ–π–∫–æ—Å—Ç—ñ –æ—Å–æ–±–æ–≤–æ–≥–æ —Å–∫–ª–∞–¥—É –¥–æ –∞—Ä—Ç–∏–ª–µ—Ä—ñ–π—Å—å–∫–∏—Ö –æ–±—Å—Ç—Ä—ñ–ª—ñ–≤ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞ —Ç–∞ –ø—Å–∏—Ö–æ—Ç—Ä–∞–≤–º—É—é—á–∏—Ö —á–∏–Ω–Ω–∏–∫—ñ–≤ –±–æ–π–æ–≤–∏—Ö –¥—ñ–π",
                location: "–ù–¢–ö –ü–°–ü",
                unit: "",
                tags: ["–ø—Å–∏—Ö–æ–ª–æ–≥—ñ—è", "–ø—Ä–∞–∫—Ç–∏–∫–∞", "–∞—Ä—Ç–∏–ª–µ—Ä—ñ—è"],
                durationMinutes: 320,
                type: "lesson",
                isDefault: true,
                createdBy: "system",
                customFields: {}
            },
            {
                title: "–©–æ–¥–µ–Ω–Ω–∞ –ø–ª–∞–Ω–µ—Ä–∫–∞",
                description: "–ü–ª–∞–Ω—É–≤–∞–Ω–Ω—è –∑–∞–≤–¥–∞–Ω—å –Ω–∞ –¥–µ–Ω—å, —Ä–æ–∑–ø–æ–¥—ñ–ª –æ–±–æ–≤'—è–∑–∫—ñ–≤",
                location: "–ö–∞–±—ñ–Ω–µ—Ç –∫–æ–º–∞–Ω–¥–∏—Ä–∞",
                unit: "",
                tags: ["–ø–ª–∞–Ω—É–≤–∞–Ω–Ω—è", "–Ω–∞—Ä–∞–¥–∞"],
                durationMinutes: 30,
                type: "meeting",
                isDefault: true,
                createdBy: "system",
                customFields: {}
            },
            {
                title: "–°—Ç—Ä–æ–π–æ–≤–∞ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∞",
                description: "–ó–∞–Ω—è—Ç—Ç—è –∑—ñ —Å—Ç—Ä–æ–π–æ–≤–æ—ó –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∏: —Å—Ç—Ä–æ—ó, –ø–æ–≤–æ—Ä–æ—Ç–∏, –ø–µ—Ä–µ—Å—É–≤–∞–Ω–Ω—è",
                location: "–ü–ª–∞—Ü",
                unit: "",
                tags: ["—Å—Ç—Ä–æ–π–æ–≤–∞", "–ø—Ä–∞–∫—Ç–∏–∫–∞"],
                durationMinutes: 90,
                type: "training",
                isDefault: true,
                createdBy: "system",
                customFields: {}
            },
            {
                title: "–§—ñ–∑–∏—á–Ω–∞ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∞",
                description: "–†–∞–Ω–∫–æ–≤–∞ —Ñ—ñ–∑–∏—á–Ω–∞ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∞: –±—ñ–≥, –≤–ø—Ä–∞–≤–∏, —Å–∏–ª–æ–≤—ñ —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è",
                location: "–°–ø–æ—Ä—Ç–∏–≤–Ω–∏–π –∑–∞–ª",
                unit: "",
                tags: ["—Ñ—ñ–∑–∏—á–Ω–∞", "–ø—Ä–∞–∫—Ç–∏–∫–∞"],
                durationMinutes: 60,
                type: "training",
                isDefault: true,
                createdBy: "system",
                customFields: {}
            },
            {
                title: "–¢–µ—Ö–Ω—ñ—á–Ω–∞ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∞",
                description: "–í–∏–≤—á–µ–Ω–Ω—è —Ç–∞ –æ–±—Å–ª—É–≥–æ–≤—É–≤–∞–Ω–Ω—è —Ç–µ—Ö–Ω—ñ–∫–∏",
                location: "–¢–µ—Ö–Ω—ñ—á–Ω–∏–π –ø–∞—Ä–∫",
                unit: "",
                tags: ["—Ç–µ—Ö–Ω—ñ—á–Ω–∞", "—Ç–µ–æ—Ä—ñ—è", "–ø—Ä–∞–∫—Ç–∏–∫–∞"],
                durationMinutes: 120,
                type: "lesson",
                isDefault: true,
                createdBy: "system",
                customFields: {}
            },
            {
                title: "–°—Ç—Ä—ñ–ª–µ—Ü—å–∫–∞ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∞",
                description: "–ó–∞–Ω—è—Ç—Ç—è –∑—ñ —Å—Ç—Ä—ñ–ª–µ—Ü—å–∫–æ—ó –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∏ –≤ —Ç–∏—Ä—ñ",
                location: "–°—Ç—Ä—ñ–ª–µ—Ü—å–∫–∏–π —Ç–∏—Ä",
                unit: "",
                tags: ["—Å—Ç—Ä—ñ–ª—å–±–∏", "–ø—Ä–∞–∫—Ç–∏–∫–∞"],
                durationMinutes: 180,
                type: "training",
                isDefault: true,
                createdBy: "system",
                customFields: {}
            },
            {
                title: "–ú–µ–¥–∏—á–Ω–∞ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∞",
                description: "–û—Å–Ω–æ–≤–∏ –Ω–∞–¥–∞–Ω–Ω—è –ø–µ—Ä—à–æ—ó –º–µ–¥–∏—á–Ω–æ—ó –¥–æ–ø–æ–º–æ–≥–∏",
                location: "–ú–µ–¥–∏—á–Ω–∏–π –ø—É–Ω–∫—Ç",
                unit: "",
                tags: ["–º–µ–¥–∏—á–Ω–∞", "—Ç–µ–æ—Ä—ñ—è", "–ø—Ä–∞–∫—Ç–∏–∫–∞"],
                durationMinutes: 120,
                type: "lesson",
                isDefault: true,
                createdBy: "system",
                customFields: {}
            },
            {
                title: "–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—ñ",
                description: "–©–æ–¥–µ–Ω–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—ñ –æ—Å–æ–±–æ–≤–æ–≥–æ —Å–∫–ª–∞–¥—É",
                location: "–ö–∞–∑–∞—Ä–º–∞",
                unit: "",
                tags: ["–ø–µ—Ä–µ–≤—ñ—Ä–∫–∞", "–≥–æ—Ç–æ–≤–Ω—ñ—Å—Ç—å"],
                durationMinutes: 45,
                type: "inspection",
                isDefault: true,
                createdBy: "system",
                customFields: {}
            },
            {
                title: "–£—Ä–æ—á–∏—Å—Ç–∞ —Ü–µ—Ä–µ–º–æ–Ω—ñ—è",
                description: "–£—Ä–æ—á–∏—Å—Ç–∞ —Ü–µ—Ä–µ–º–æ–Ω—ñ—è, –ø–∞—Ä–∞–¥, –Ω–∞–≥–æ—Ä–æ–¥–∂–µ–Ω–Ω—è",
                location: "–ü–ª–∞—Ü",
                unit: "",
                tags: ["—Ü–µ—Ä–µ–º–æ–Ω—ñ—è", "—É—Ä–æ—á–∏—Å—Ç—ñ—Å—Ç—å"],
                durationMinutes: 120,
                type: "ceremony",
                isDefault: true,
                createdBy: "system",
                customFields: {}
            }
        ];

        // –î–µ—Ñ–æ–ª—Ç–Ω—ñ –∞–≤—Ç–æ–¥–æ–ø–æ–≤–Ω–µ–Ω–Ω—è
        const defaultAutocomplete = {
            locations: [
                "–ù–∞–≤—á–∞–ª—å–Ω–∏–π –∫–ª–∞—Å ‚Ññ1", "–ù–∞–≤—á–∞–ª—å–Ω–∏–π –∫–ª–∞—Å ‚Ññ2", "–ù–∞–≤—á–∞–ª—å–Ω–∏–π –∫–ª–∞—Å ‚Ññ3",
                "–ê–∫—Ç–æ–≤–∏–π –∑–∞–ª", "–°–ø–æ—Ä—Ç–∏–≤–Ω–∏–π –∑–∞–ª", "–ü–ª–∞—Ü", "–°—Ç—Ä—ñ–ª–µ—Ü—å–∫–∏–π —Ç–∏—Ä",
                "–ù–∞–≤—á–∞–ª—å–Ω–∏–π –ø–æ–ª—ñ–≥–æ–Ω", "–¢–µ—Ö–Ω—ñ—á–Ω–∏–π –ø–∞—Ä–∫", "–ú–∞–π—Å—Ç–µ—Ä–Ω—è", "–á–¥–∞–ª—å–Ω—è",
                "–ö–∞–∑–∞—Ä–º–∞", "–ê–≤—Ç–æ–ø–∞—Ä–∫", "–ú–µ–¥–∏—á–Ω–∏–π –ø—É–Ω–∫—Ç", "–ù–¢–ö –ü–°–ü", "–û–±–∫–∞—Ç–∫–∞ —Ç–∞–Ω–∫–æ–º",
                "–ö–∞–±—ñ–Ω–µ—Ç –∫–æ–º–∞–Ω–¥–∏—Ä–∞"
            ],
            units: [
                "1 –ù–ë 1 –ù–†", "1 –ù–ë 2 –ù–†", "1 –ù–ë 3 –ù–†", "1 –ù–ë 4 –ù–†", "1 –ù–ë 5 –ù–†",
                "2 –ù–ë 1 –ù–†", "2 –ù–ë 2 –ù–†", "2 –ù–ë 3 –ù–†", "2 –ù–ë 4 –ù–†", "2 –ù–ë 5 –ù–†",
                "–ì—Ä–∞–Ω—ñ—Ç-1 1 –ù–†", "–ì—Ä–∞–Ω—ñ—Ç-1 2 –ù–†", "–ì—Ä–∞–Ω—ñ—Ç-1 3 –ù–†",
                "–ì—Ä–∞–Ω—ñ—Ç-95 1 –ù–†", "–ì—Ä–∞–Ω—ñ—Ç-95 2 –ù–†", "–®–ü–†", "190 –ù–¶"
            ],
            tags: [
                "—Ç–∞–∫—Ç–∏–∫–∞", "—Ñ—ñ–∑–∏—á–Ω–∞", "—Å—Ç—Ä–æ–π–æ–≤–∞", "—Ç–µ–æ—Ä—ñ—è", "–ø—Ä–∞–∫—Ç–∏–∫–∞", "—Ç–µ—Ö–Ω—ñ—á–Ω–∞",
                "–≤–æ–¥—ñ–Ω–Ω—è", "—Å—Ç—Ä—ñ–ª—å–±–∏", "–º–µ–¥–∏—á–Ω–∞", "–∑–≤'—è–∑–æ–∫", "—ñ–Ω–∂–µ–Ω–µ—Ä–Ω–∞", "—Ö—ñ–º–∑–∞—Ö–∏—Å—Ç",
                "—Ç–æ–ø–æ–≥—Ä–∞—Ñ—ñ—è", "—Å—Ç–∞—Ç—É—Ç–∏", "–ø—Å–∏—Ö–æ–ª–æ–≥—ñ—è", "–±—Ä–æ–Ω–µ—Ç–µ—Ö–Ω—ñ–∫–∞", "–∞—Ä—Ç–∏–ª–µ—Ä—ñ—è"
            ]
        };

        function showStatus(message, type = 'info') {
            const statusDiv = document.getElementById('status');
            statusDiv.className = `status ${type}`;
            statusDiv.innerHTML = message;
        }

        function updateProgress(percent) {
            const progressContainer = document.getElementById('progressContainer');
            const progressBar = document.getElementById('progressBar');
            
            if (percent > 0) {
                progressContainer.classList.remove('hidden');
                progressBar.style.width = `${percent}%`;
            } else {
                progressContainer.classList.add('hidden');
            }
        }

        // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è Firebase –ø—Ä–∏ –∑–∞–≥—Ä—É–∑—Ü—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏
        window.addEventListener('load', function() {
            setTimeout(() => {
                if (typeof firebase === 'undefined') {
                    showStatus('‚ö†Ô∏è Firebase SDK –Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∏–π. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç—É —Ç–∞ –ø–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ —Å—Ç–æ—Ä—ñ–Ω–∫—É.', 'error');
                } else {
                    showStatus('‚ÑπÔ∏è Firebase SDK –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∏–π. –í–≤–µ–¥—ñ—Ç—å –¥–∞–Ω—ñ –ø—Ä–æ–µ–∫—Ç—É —Ç–∞ –ø—ñ–¥–∫–ª—é—á—ñ—Ç—å—Å—è.', 'info');
                }
            }, 1000);
        });

        // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∏–π Firebase
        function checkFirebaseAvailability() {
            return typeof firebase !== 'undefined' && firebase.firestore;
        }

        async function initFirebase() {
            // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∏–π Firebase
            if (!checkFirebaseAvailability()) {
                showStatus('‚ùå Firebase SDK –Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∏–π. –ü–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ —Å—Ç–æ—Ä—ñ–Ω–∫—É —Ç–∞ —Å–ø—Ä–æ–±—É–π—Ç–µ –∑–Ω–æ–≤—É.', 'error');
                return;
            }
            
            const apiKey = document.getElementById('apiKey').value;
            const projectId = document.getElementById('projectId').value;
            
            if (!apiKey || !projectId) {
                showStatus('‚ùå –ë—É–¥—å –ª–∞—Å–∫–∞, –≤–≤–µ–¥—ñ—Ç—å API Key —Ç–∞ Project ID', 'error');
                return;
            }
            
            try {
                // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∏ –≤–∂–µ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω–∏–π Firebase
                if (firebase.apps.length > 0) {
                    firebase.app().delete();
                }
                
                const firebaseConfig = {
                    apiKey: apiKey,
                    authDomain: `${projectId}.firebaseapp.com`,
                    projectId: projectId,
                    storageBucket: `${projectId}.appspot.com`,
                    messagingSenderId: "123456789",
                    appId: "1:123456789:web:abcd1234"
                };
                
                firebase.initializeApp(firebaseConfig);
                db = firebase.firestore();
                auth = firebase.auth();
                isFirebaseInitialized = true;
                
                // –°–ª—É—Ö–∞—á —Å—Ç–∞–Ω—É –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó
                auth.onAuthStateChanged((user) => {
                    const authStatus = document.getElementById('authStatus');
                    const authStatusText = document.getElementById('authStatusText');
                    
                    if (user) {
                        isAuthenticated = true;
                        authStatus.style.display = 'block';
                        authStatus.className = 'status success';
                        authStatusText.textContent = `–ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π: ${user.uid}`;
                        
                        document.getElementById('createBtn').disabled = false;
                        document.getElementById('deleteBtn').disabled = false;
                        document.getElementById('checkBtn').disabled = false;
                    } else {
                        isAuthenticated = false;
                        authStatus.style.display = 'block';
                        authStatus.className = 'status error';
                        authStatusText.textContent = '–ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π';
                        
                        document.getElementById('createBtn').disabled = true;
                        document.getElementById('deleteBtn').disabled = true;
                        document.getElementById('checkBtn').disabled = true;
                    }
                });
                
                showStatus('‚úÖ Firebase —É—Å–ø—ñ—à–Ω–æ –ø—ñ–¥–∫–ª—é—á–µ–Ω–æ! –¢–µ–ø–µ—Ä –∞–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å.', 'success');
            } catch (error) {
                showStatus(`‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è: ${error.message}`, 'error');
            }
        }

        async function signInAnonymously() {
            if (!isFirebaseInitialized) {
                showStatus('‚ùå –°–ø–æ—á–∞—Ç–∫—É –ø—ñ–¥–∫–ª—é—á—ñ—Ç—å—Å—è –¥–æ Firebase', 'error');
                return;
            }
            
            try {
                showStatus('üîê –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è...', 'info');
                await auth.signInAnonymously();
                showStatus('‚úÖ –£—Å–ø—ñ—à–Ω–æ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–æ!', 'success');
            } catch (error) {
                showStatus(`‚ùå –ü–æ–º–∏–ª–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó: ${error.message}`, 'error');
            }
        }

        async function createTemplates() {
            if (!isFirebaseInitialized) {
                showStatus('‚ùå –°–ø–æ—á–∞—Ç–∫—É –ø—ñ–¥–∫–ª—é—á—ñ—Ç—å—Å—è –¥–æ Firebase', 'error');
                return;
            }
            
            if (!isAuthenticated) {
                showStatus('‚ùå –°–ø–æ—á–∞—Ç–∫—É –∞–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å', 'error');
                return;
            }
            
            const groupId = document.getElementById('groupId').value;
            if (!groupId) {
                showStatus('‚ùå –í–≤–µ–¥—ñ—Ç—å ID –≥—Ä—É–ø–∏', 'error');
                return;
            }
            
            try {
                showStatus('üöÄ –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–µ–º–ø–ª–µ–π—Ç—ñ–≤...', 'info');
                updateProgress(0);
                
                const batch = db.batch();
                const now = firebase.firestore.FieldValue.serverTimestamp();
                
                // –°—Ç–≤–æ—Ä—é—î–º–æ —Ç–µ–º–ø–ª–µ–π—Ç–∏
                for (let i = 0; i < defaultTemplates.length; i++) {
                    const template = defaultTemplates[i];
                    const templateRef = db.collection('groups')
                        .doc(groupId)
                        .collection('templates')
                        .doc();
                    
                    batch.set(templateRef, {
                        ...template,
                        groupId: groupId,
                        createdAt: now,
                        updatedAt: now
                    });
                    
                    updateProgress((i + 1) / (defaultTemplates.length + 3) * 100);
                }
                
                // –°—Ç–≤–æ—Ä—é—î–º–æ –∞–≤—Ç–æ–¥–æ–ø–æ–≤–Ω–µ–Ω–Ω—è
                const autocompleteRef = db.collection('groups')
                    .doc(groupId)
                    .collection('autocomplete_data');
                
                batch.set(autocompleteRef.doc('locations'), {
                    items: defaultAutocomplete.locations,
                    updatedAt: now
                });
                updateProgress((defaultTemplates.length + 1) / (defaultTemplates.length + 3) * 100);
                
                batch.set(autocompleteRef.doc('units'), {
                    items: defaultAutocomplete.units,
                    updatedAt: now
                });
                updateProgress((defaultTemplates.length + 2) / (defaultTemplates.length + 3) * 100);
                
                batch.set(autocompleteRef.doc('tags'), {
                    items: defaultAutocomplete.tags,
                    updatedAt: now
                });
                updateProgress(100);
                
                await batch.commit();
                
                showStatus(`‚úÖ –£—Å–ø—ñ—à–Ω–æ —Å—Ç–≤–æ—Ä–µ–Ω–æ ${defaultTemplates.length} —Ç–µ–º–ø–ª–µ–π—Ç—ñ–≤ —Ç–∞ –∞–≤—Ç–æ–¥–æ–ø–æ–≤–Ω–µ–Ω–Ω—è –¥–ª—è –≥—Ä—É–ø–∏ "${groupId}"!`, 'success');
                updateProgress(0);
                
            } catch (error) {
                showStatus(`‚ùå –ü–æ–º–∏–ª–∫–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è: ${error.message}`, 'error');
                updateProgress(0);
            }
        }

        async function deleteAllTemplates() {
            if (!isFirebaseInitialized) {
                showStatus('‚ùå –°–ø–æ—á–∞—Ç–∫—É –ø—ñ–¥–∫–ª—é—á—ñ—Ç—å—Å—è –¥–æ Firebase', 'error');
                return;
            }
            
            if (!isAuthenticated) {
                showStatus('‚ùå –°–ø–æ—á–∞—Ç–∫—É –∞–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å', 'error');
                return;
            }
            
            const groupId = document.getElementById('groupId').value;
            if (!groupId) {
                showStatus('‚ùå –í–≤–µ–¥—ñ—Ç—å ID –≥—Ä—É–ø–∏', 'error');
                return;
            }
            
            if (!confirm(`–í–∏ –¥—ñ–π—Å–Ω–æ —Ö–æ—á–µ—Ç–µ –≤–∏–¥–∞–ª–∏—Ç–∏ –í–°–Ü —Ç–µ–º–ø–ª–µ–π—Ç–∏ –≥—Ä—É–ø–∏ "${groupId}"?`)) {
                return;
            }
            
            try {
                showStatus('üóëÔ∏è –í–∏–¥–∞–ª–µ–Ω–Ω—è —Ç–µ–º–ø–ª–µ–π—Ç—ñ–≤...', 'info');
                
                // –í–∏–¥–∞–ª—è—î–º–æ —Ç–µ–º–ø–ª–µ–π—Ç–∏
                const templatesSnapshot = await db.collection('groups')
                    .doc(groupId)
                    .collection('templates')
                    .get();
                
                const batch = db.batch();
                templatesSnapshot.docs.forEach(doc => batch.delete(doc.ref));
                
                // –í–∏–¥–∞–ª—è—î–º–æ –∞–≤—Ç–æ–¥–æ–ø–æ–≤–Ω–µ–Ω–Ω—è
                const autocompleteSnapshot = await db.collection('groups')
                    .doc(groupId)
                    .collection('autocomplete_data')
                    .get();
                
                autocompleteSnapshot.docs.forEach(doc => batch.delete(doc.ref));
                
                await batch.commit();
                
                showStatus(`‚úÖ –í—Å—ñ —Ç–µ–º–ø–ª–µ–π—Ç–∏ –≥—Ä—É–ø–∏ "${groupId}" –≤–∏–¥–∞–ª–µ–Ω–æ!`, 'success');
                
            } catch (error) {
                showStatus(`‚ùå –ü–æ–º–∏–ª–∫–∞ –≤–∏–¥–∞–ª–µ–Ω–Ω—è: ${error.message}`, 'error');
            }
        }

        async function checkExisting() {
            if (!isFirebaseInitialized) {
                showStatus('‚ùå –°–ø–æ—á–∞—Ç–∫—É –ø—ñ–¥–∫–ª—é—á—ñ—Ç—å—Å—è –¥–æ Firebase', 'error');
                return;
            }
            
            if (!isAuthenticated) {
                showStatus('‚ùå –°–ø–æ—á–∞—Ç–∫—É –∞–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å', 'error');
                return;
            }
            
            const groupId = document.getElementById('groupId').value;
            if (!groupId) {
                showStatus('‚ùå –í–≤–µ–¥—ñ—Ç—å ID –≥—Ä—É–ø–∏', 'error');
                return;
            }
            
            try {
                const templatesSnapshot = await db.collection('groups')
                    .doc(groupId)
                    .collection('templates')
                    .get();
                
                const autocompleteSnapshot = await db.collection('groups')
                    .doc(groupId)
                    .collection('autocomplete_data')
                    .get();
                
                showStatus(`üìä –ì—Ä—É–ø–∞ "${groupId}": ${templatesSnapshot.size} —Ç–µ–º–ø–ª–µ–π—Ç—ñ–≤, ${autocompleteSnapshot.size} –Ω–∞–±–æ—Ä—ñ–≤ –∞–≤—Ç–æ–¥–æ–ø–æ–≤–Ω–µ–Ω–Ω—è`, 'info');
                
            } catch (error) {
                showStatus(`‚ùå –ü–æ–º–∏–ª–∫–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏: ${error.message}`, 'error');
            }
        }
    </script>
</body>
</html>